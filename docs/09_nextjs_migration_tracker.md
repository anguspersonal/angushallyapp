# 09_migration_tracker.md

# üõ†Ô∏è Next.js Migration Tracker

This is the **working task board** for the CRA ‚Üí Next.js migration of `angushallyapp`.

---

## üîÑ In Progress

### üö® Current Issues to Resolve
- [ ] **Build Manifest Errors** ‚Äì Multiple ENOENT errors for `_buildManifest.js.tmp` files in Next.js dev server
- [x] **Missing CSS Module** ‚Äì `./strava.module.css` not found in `/projects/strava` page ‚úÖ **RESOLVED**
- [x] **Port Conflicts** ‚Äì Multiple Next.js dev servers running on port 3001 causing conflicts ‚úÖ **RESOLVED** (2025-07-12)
- [x] **Authentication Token Field Mismatch** ‚Äì Backend expects `token` field, frontend sends `credential` ‚úÖ **RESOLVED** (2025-07-10)
- [ ] **/collab Performance Tuning** ‚Äì Optimize load speed and reduce CPU spikes in Next.js dev mode üîÑ **IN PROGRESS**

### üîß Infrastructure Issues
- [ ] **Next.js Build Stability** ‚Äì Resolve Turbopack compilation errors and manifest issues
- [x] **Development Environment** ‚Äì Clean up multiple running processes and port conflicts ‚úÖ **RESOLVED** (2025-07-11)
- [x] **CSS Module Migration** ‚Äì Ensure all CSS modules are properly copied and imported ‚úÖ **RESOLVED**
- [x] **Static Asset Loading** ‚Äì Fixed CSS import issues in layout.tsx ‚úÖ **RESOLVED**

---

## ‚è≠Ô∏è Next Priority

- [x] `/projects` ‚Äì Static overview page of all projects ‚úÖ
- [x] Complete Data Value Game migration (remaining components) ‚úÖ
- [x] Migrate other simple project pages (Instapaper AI, etc.) ‚úÖ **COMPLETED**
- [x] `/blog` ‚Äì Dynamic blog index page (list, tags, metadata) ‚úÖ
- [x] `/blog/:slug` ‚Äì Blog post page with SSG (`generateStaticParams`) ‚úÖ
- [x] `/cv` ‚Äì Static resume page ‚úÖ **COMPLETED**
- [x] **Fix Strava Project** ‚Äì Resolve missing CSS module and complete migration ‚úÖ **RESOLVED**
- [x] `/collab` ‚Äì Complex collaboration page with multiple components ‚úÖ **COMPLETED**

---

## üîÉ Backlog

### üî• High Complexity (SSR, State-heavy)
- [x] `/projects/habit` ‚Äì Complex UI state + goal tracking ‚úÖ
- [x] `/projects/strava` ‚Äì Strava API integration, graph display ‚úÖ **CSS Module Issue Resolved**

### ‚úÖ Bookmark Sub-Project Migration Complete
- [x] `/projects/bookmarks` ‚Äì Complete bookmark management system with Instagram Intelligence
  - [x] Create directory structure `next-ui/src/app/projects/bookmarks/`
  - [x] Migrate main page component to Next.js App Router
  - [x] Create supporting components (BookmarkCard, Sidebar)
  - [x] Migrate Instagram Intelligence components (InstagramEnhancer, InstagramAnalysisDisplay)
  - [x] Create shared types in `next-ui/src/types/common.ts`
  - [x] Install required dependencies (@mantine/notifications)
  - [x] Test locally at `/next/projects/bookmarks`
  - [x] Verify page loads correctly via Express proxy
  - [x] **Status**: ‚úÖ **Complete** - All components migrated with TypeScript support

### üîÅ PWA & Offline
- [ ] Migrate Service Worker ‚Äì Switch to `next-pwa`, match CRA logic
  - **Status**: Ready to revisit after SSR routes are stable and hydration issues are eliminated
  - **Note**: Service worker and manifest now conditionally disabled in development
- [ ] Offline Route Handling ‚Äì Ensure fallback behavior and cache versioning

### üßº Cleanup
- [ ] Remove CRA App ‚Äì Fully delete CRA when all routes are migrated
- [ ] Optimize Express Routing ‚Äì Remove CRA proxy rules, compress static
- [ ] Final Lighthouse Audit ‚Äì Performance & SEO pass
- [ ] Consolidate types + utils ‚Äì Move final shared files to `/shared`

---

## ‚úÖ Completed

### Critical Infrastructure Fixes ‚úÖ
- [x] **Static Asset Loading Fix** ‚Äì Resolved CSS import issues preventing Next.js app from rendering
  - [x] Copied `index.css` and `general.css` from CRA to `next-ui/src/`
  - [x] Updated `layout.tsx` to import CSS files from correct location
  - [x] Verified Next.js app renders successfully at http://localhost:3000
  - [x] Confirmed no 404s for static assets (CSS/JS chunks)

### `/contact` Migration ‚úÖ
- [x] Copy CRA component to `next-ui/src/app/contact/page.tsx`
- [x] Convert to TSX + use App Router
- [x] Test locally at `/next/contact`
- [x] Install required dependencies (@mantine/form, react-google-recaptcha)
- [x] Fix TypeScript color issues for Mantine v7
- [x] Update form validation and reCAPTCHA integration
- [x] Verify page loads correctly via Express proxy

### Footer Layout Integration ‚úÖ
- [x] Create Footer component for Next.js app
- [x] Migrate from CRA Footer with TypeScript and Mantine v7 colors
- [x] Add Footer to ClientLayout using AppShell.Footer
- [x] Fix color compatibility issues (dimmed ‚Üí secondary, gray ‚Üí secondary)
- [x] Verify footer appears on all pages via Express proxy

### `/projects` Migration ‚úÖ
- [x] Copy CRA component to `next-ui/src/app/projects/page.tsx`
- [x] Convert to TSX + use App Router
- [x] Use existing project data from `next-ui/src/data/projectList.ts`
- [x] Test locally at `/next/projects`
- [x] Verify page loads correctly via Express proxy

### Individual Project Pages Migration ‚úÖ
- [x] `/projects/ai/text-analysis` ‚Äì Simple AI text analysis tool
  - [x] Create directory structure `next-ui/src/app/projects/ai/text-analysis/`
  - [x] Migrate main component to Next.js App Router
  - [x] Create supporting `ai.ts` utility with API client integration
  - [x] Fix Mantine v7 compatibility issues (LoadingOverlay, Box styling)
  - [x] Test locally at `/next/projects/ai/text-analysis`
  - [x] Verify page loads correctly via Express proxy

- [x] `/projects/ai/instapaper` ‚Äì Instapaper AI analysis tool
  - [x] Create directory structure `next-ui/src/app/projects/ai/instapaper/`
  - [x] Create main page component with TypeScript and Mantine v7
  - [x] Implement placeholder AI analysis interface
  - [x] Add future features roadmap and integration plans
  - [x] Fix Mantine v7 color compatibility issues
  - [x] Test build compilation and TypeScript compliance
  - [x] **Status**: ‚úÖ **Complete** - Ready for future Instapaper API integration

- [x] `/projects/eat-safe-uk` ‚Äì Google Maps + hygiene score integration
  - [x] Create directory structure `next-ui/src/app/projects/eat-safe-uk/`
  - [x] Migrate main component to Next.js App Router with TypeScript
  - [x] Create supporting components (GMapView, GMapsSearchBar, NearbySearchButton, Markers)
  - [x] Migrate utility functions (fetchHygieneScores, nearbySearch, askUserLocation, getDynamicPlaceholder)
  - [x] Install required dependencies (@vis.gl/react-google-maps, axios)
  - [x] Fix authentication error handling in Next.js AuthProvider
  - [x] Copy CSS files and maintain styling
  - [x] Test locally at `/next/projects/eat-safe-uk`
  - [x] Verify Google Maps integration and hygiene score functionality

### Data Value Game Migration ‚úÖ
- [x] Create directory structure `next-ui/src/app/projects/data-value-game/`
- [x] Migrate main component to Next.js App Router
- [x] Create DVGHeader component and CSS
- [x] Create Welcome component
- [x] Migrate remaining components (GameBoard, Card, Win, Lose, etc.)
- [x] Create CTA-GuessAutomotive component
- [x] Copy all CSS files (DataValueGame.css, Gameboard.css, DVGFooter.css, DVGHeader.css)
- [x] Copy Industries.json data
- [x] Test game functionality

### `/login` Migration ‚úÖ
- [x] Copy CRA component to `next-ui/src/app/login/page.tsx`
- [x] Convert to TSX + use App Router
- [x] Test locally at `/next/login`
- [x] (Optional) Test in production at `/next/login`
- [x] Redirect `/login` to Next.js version in Express
- [x] Remove CRA login page
- [x] Move page from `/next/login` ‚Üí `/login`

### `/blog` Migration ‚úÖ
- [x] Copy CRA components to `next-ui/src/app/blog/` and `next-ui/src/app/blog/[slug]/`
- [x] Convert to TSX + use App Router with dynamic routing
- [x] Install required dependencies (react-markdown, remark-gfm)
- [x] Update blog types to match CRA version
- [x] Migrate fetchBlogData utility with proper TypeScript types
- [x] Create BlogSnippet component with attribution handling
- [x] Add CSS styling for markdown content
- [x] Fix Mantine v7 compatibility issues (color props)
- [x] Test locally at `/next/blog` and `/next/blog/[slug]`
- [x] Verify blog listing and individual post pages load correctly

### `/collab` Migration ‚úÖ
- [x] Create directory structure `next-ui/src/app/collab/`
- [x] Migrate main page component to Next.js App Router with TypeScript
- [x] Create supporting components (TraitGrid, CustomCarousel, TestimonialSlide, CaseStudySlide, FounderJourney)
- [x] Migrate data files (testimonials.ts, caseStudies.tsx) with proper TypeScript interfaces
- [x] Install required dependencies (@mantine/carousel, embla-carousel-autoplay)
- [x] Fix Mantine v7 compatibility issues (color props, Group justify, Button rightSection)
- [x] Update routing from React Router to Next.js Link
- [x] Convert complex animations and interactions to TypeScript
- [x] Test locally at `/next/collab`
- [x] Verify all sections load correctly (Hero, TraitGrid, Accordion, Carousel, FounderJourney)

### `/cv` Migration ‚úÖ
- [x] Create directory structure `next-ui/src/app/cv/`
- [x] Migrate main page component to Next.js App Router with TypeScript
- [x] Preserve all CV sections and responsive design
- [x] Maintain styling and layout consistency
- [x] Test locally at `/next/cv`
- [x] Verify page loads correctly via Express proxy

### `/projects/habit` Migration ‚úÖ
- [x] Create directory structure `next-ui/src/app/projects/habit/`
- [x] Migrate main page component to Next.js App Router with TypeScript
- [x] Create supporting components (HabitHeader, HabitTile, HabitDrawer, HabitCombobox)
- [x] Add habit types to `next-ui/src/types/common.ts` (HabitLog, HabitType, DrinkCatalogItem, etc.)
- [x] Migrate utility functions (habit.ts, aggregateService.ts, calculateUnits.ts)
- [x] Fix Mantine v7 compatibility issues (color props, ActionIcon variants)
- [x] Update API client integration to use shared apiClient
- [x] Test locally at `/next/projects/habit`
- [x] Verify habit tracking functionality and drawer interactions

### `/projects/strava` Migration ‚úÖ
- [x] Create directory structure `next-ui/src/app/projects/strava/`
- [x] Migrate main page component to Next.js App Router with TypeScript
- [x] Copy CSS module files and resolve import issues
- [x] Maintain Strava API integration and graph display
- [x] Fix Mantine v7 compatibility issues
- [x] Test locally at `/next/projects/strava`
- [x] Verify Strava integration and functionality

### `/projects/bookmarks` Migration ‚úÖ
- [x] Create directory structure `next-ui/src/app/projects/bookmarks/`
- [x] Migrate main page component to Next.js App Router with TypeScript
- [x] Create supporting components (BookmarkCard, Sidebar)
- [x] Migrate Instagram Intelligence components (InstagramEnhancer, InstagramAnalysisDisplay)
- [x] Create shared types in `next-ui/src/types/common.ts`
- [x] Install required dependencies (@mantine/notifications)
- [x] Test locally at `/next/projects/bookmarks`
- [x] Verify page loads correctly via Express proxy
- [x] **Status**: ‚úÖ **Complete** - All components migrated with TypeScript support

### `layout.tsx` Shared Layout Migration ‚úÖ
- [x] Create `next-ui/src/app/layout.tsx` with Mantine and global styles
- [x] Port `Header` and `Footer` components to Next.js
- [x] Wrap all pages in `ClientLayout`
- [x] Register service worker in layout
- [x] Confirm layout applies to all routes

### Auth Flow Migration ‚úÖ
- [x] Update backend auth routes to use secure HttpOnly cookies
- [x] Add cookie-parser middleware to Express server
- [x] Update auth middleware to read from cookies and headers
- [x] Create Next.js API routes for login/logout
- [x] Update Next.js AuthProvider to use cookie-based auth
- [x] Create Next.js middleware for route protection
- [x] Update API client to use credentials and remove token handling
- [x] Update login page to use new cookie-based flow

See [`09_migration_log.md`](09_migration_log.md) for full changelog.

---

## üß† Notes

- When you complete an item:
  - [x] Check it off here
  - ‚ûï Add it to `09_migration_log.md` with date + details
- When moving a task:
  - Backlog ‚Üí Next ‚Üí In Progress ‚Üí Log
- Review and update this tracker at the **start and end of each work session**

> Maintained per [01_guidance.md](01_guidance.md) documentation rules.
